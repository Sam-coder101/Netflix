<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Netflix Clone - My List" />
  <title>My List | Netflix Clone</title>
  <link rel="stylesheet" href="mylist.css">
  <link rel="icon" href="https://images.ctfassets.net/4cd45et68cgf/Rx83JoRDMkYNlMC9MKzcB/2b14d5a59fc3937afd3f03191e19502d/Netflix-Symbol.png?w=700&h=456"/>
</head>
<body>

  <header class="site-header">
    <div class="header-inner">
      <a class="logo" href="#">
        <img src="https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg" alt="Netflix logo" />
      </a>
      <nav class="primary-nav">
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="series.html">Series</a></li>
          <li><a href="movies.html">Movies</a></li>
          <li><a href="new&popular.html">New & Popular</a></li>
          <li><a href="mylist.html" class="active">My List</a></li>
          <li><a href="kids.html">Kids</a></li>
          <li><div class="theme-switch-wrapper">
  <label class="theme-switch">
    <input type="checkbox" id="themeToggle">
    <span class="slider round"></span>
  </label>
</div>
</li>
        </ul>
      </nav>
    </div>
  </header>

  <section class="page-header">
    <div class="header-content">
      <h1>My List</h1>
      <p>Your personal collection of favorites and watchlist items</p>
      <div class="list-stats">
        <div class="stat-item">
          <span class="stat-number" id="totalItems">12</span>
          <span class="stat-label">Total Items</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="moviesCount">7</span>
          <span class="stat-label">Movies</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="seriesCount">5</span>
          <span class="stat-label">Series</span>
        </div>
      </div>
    </div>
  </section>

  <div class="filter-bar">
    <div class="filter-content">
      <div class="filter-group">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="movie">Movies</button>
        <button class="filter-btn" data-filter="series">Series</button>
        <button class="filter-btn" data-filter="action">Action</button>
        <button class="filter-btn" data-filter="drama">Drama</button>
        <button class="filter-btn" data-filter="scifi">Sci-Fi</button>
      </div>
      <div class="sort-dropdown">
        <label for="sortSelect">Sort by:</label>
        <select id="sortSelect">
          <option value="recent">Recently Added</option>
          <option value="title">Title A-Z</option>
          <option value="year">Year</option>
          <option value="rating">Rating</option>
        </select>
      </div>
    </div>
  </div>

  <section class="content-section">
    <div class="view-toggle">
      <button class="view-btn active" data-view="grid">⊞ Grid View</button>
      <button class="view-btn" data-view="list">☰ List View</button>
    </div>

    <div class="list-grid" id="listContainer">
      <!-- Watchlist items will be rendered here from localStorage -->
    </div>

    <script>
      // Populate the list container from localStorage watchlist key
      (function(){
        const KEY = 'watchlist';
        function load(){ try { return JSON.parse(localStorage.getItem(KEY)) || []; } catch(e){ return []; } }
        function createItemMarkup(item){
          const div = document.createElement('div');
          div.className = 'list-item';
          div.setAttribute('data-type','movie');
          div.setAttribute('data-title', item.title || 'Untitled');
          div.innerHTML = `
            <span class="added-date">Saved</span>
            <img src="${item.poster}" alt="${item.title}">
            <div class="item-overlay">
              <div class="item-info">
                <h3>${item.title}</h3>
                <div class="item-meta"><span class="match-score"> </span></div>
                <div class="item-genres"></div>
                <p class="item-description"></p>
              </div>
            </div>
            <div class="item-actions">
              <button class="action-btn play" onclick="playContent('${item.title.replace(/'/g, "\\'")}')" title="Play">▶</button>
              <button class="action-btn remove" onclick="removeFromList(event, this)" title="Remove from List">✕</button>
            </div>
          `;
          return div;
        }

        const container = document.getElementById('listContainer');
        if (!container) return;
        const items = load();
        if(items.length === 0){
          container.innerHTML = '<p style="padding:20px;">Your list is empty. Add movies from the homepage.</p>';
        } else {
          container.innerHTML = '';
          items.forEach(i => container.appendChild(createItemMarkup(i)));
        }
      })();
    </script>
  </section>

  <div class="content-modal" id="contentModal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeModal()">×</button>
      <div class="modal-hero">
        <img src="https://cdn.pixabay.com/photo/2019/04/24/21/55/cinema-4153289_1280.jpg" alt="Content">
        <div class="modal-hero-content">
          <h1 class="modal-title" id="modalTitle">Inception</h1>
          <div class="modal-buttons">
            <button class="btn primary">▶ Play</button>
            <button class="btn secondary" onclick="removeFromListModal()">✕ Remove from List</button>
          </div>
        </div>
      </div>
      <div class="modal-body">
        <div class="modal-info-grid">
          <div class="modal-main-info">
            <p class="modal-description" id="modalDescription">
              A thief who steals corporate secrets through the use of dream-sharing technology is given the inverse task of planting an idea into the mind of a C.E.O.
            </p>
            <div class="modal-genres">
              <span class="genre-tag">Action</span>
              <span class="genre-tag">Sci-Fi</span>
              <span class="genre-tag">Thriller</span>
            </div>
          </div>
          <div class="modal-meta-info">
            <div class="meta-row">
              <span class="meta-label">Cast:</span>
              <span class="meta-value">Leonardo DiCaprio, Tom Hardy</span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Director:</span>
              <span class="meta-value">Christopher Nolan</span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Rating:</span>
              <span class="meta-value">⭐ 97% Match</span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Added:</span>
              <span class="meta-value">2 days ago</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    let currentView = 'grid';

    const viewButtons = document.querySelectorAll('.view-btn');
    const listContainer = document.getElementById('listContainer');

    viewButtons.forEach(btn => {
      btn.addEventListener('click', function() {
        viewButtons.forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        const view = this.getAttribute('data-view');
        currentView = view;
        
        if (view === 'list') {
          listContainer.classList.remove('list-grid');
          listContainer.classList.add('list-detailed');
        } else {
          listContainer.classList.remove('list-detailed');
          listContainer.classList.add('list-grid');
        }
      });
    });

    const filterButtons = document.querySelectorAll('.filter-btn');
    const listItems = document.querySelectorAll('.list-item');

    filterButtons.forEach(btn => {
      btn.addEventListener('click', function() {
        filterButtons.forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        const filter = this.getAttribute('data-filter');
        
        listItems.forEach(item => {
          if (filter === 'all') {
            item.style.display = 'block';
          } else if (filter === 'movie' || filter === 'series') {
            item.style.display = item.getAttribute('data-type') === filter ? 'block' : 'none';
          } else {
            const genres = item.getAttribute('data-genre');
            item.style.display = genres.includes(filter) ? 'block' : 'none';
          }
        });
        
        updateStats();
      });
    });

    const sortSelect = document.getElementById('sortSelect');
    
    sortSelect.addEventListener('change', function() {
      const sortBy = this.value;
      const itemsArray = Array.from(listItems);
      
      itemsArray.sort((a, b) => {
        if (sortBy === 'title') {
          return a.getAttribute('data-title').localeCompare(b.getAttribute('data-title'));
        } else if (sortBy === 'year') {
          return parseInt(b.getAttribute('data-year')) - parseInt(a.getAttribute('data-year'));
        } else if (sortBy === 'rating') {
          return parseInt(b.getAttribute('data-rating')) - parseInt(a.getAttribute('data-rating'));
        }
        return 0;
      });
      
      itemsArray.forEach(item => listContainer.appendChild(item));
    });

    function removeFromList(event, button) {
      event.stopPropagation();
      const item = button.closest('.list-item');
      const title = item.getAttribute('data-title');

      // remove from localStorage watchlist
      try {
        const KEY = 'watchlist';
        const list = JSON.parse(localStorage.getItem(KEY)) || [];
        const idx = list.findIndex(i => i.title === title);
        if (idx !== -1) { list.splice(idx,1); localStorage.setItem(KEY, JSON.stringify(list)); }
      } catch(e) { /* ignore */ }

      item.style.animation = 'fadeOut 0.3s ease';

      setTimeout(() => {
        item.remove();
        showToast(`"${title}" removed from your list`);
        updateStats();
      }, 300);
    }

    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeOut {
        to { opacity: 0; transform: scale(0.8); }
      }
    `;
    document.head.appendChild(style);

    function playContent(title) {
      showToast(`Playing "${title}"...`);
    }

    function updateStats() {
      const visibleItems = Array.from(listItems).filter(item => item.style.display !== 'none');
      const movies = visibleItems.filter(item => item.getAttribute('data-type') === 'movie').length;
      const series = visibleItems.filter(item => item.getAttribute('data-type') === 'series').length;
      
      document.getElementById('totalItems').textContent = visibleItems.length;
      document.getElementById('moviesCount').textContent = movies;
      document.getElementById('seriesCount').textContent = series;
    }

    function openModal(title) {
      const modal = document.getElementById('contentModal');
      document.getElementById('modalTitle').textContent = title;
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      const modal = document.getElementById('contentModal');
      modal.classList.remove('active');
      document.body.style.overflow = '';
    }

    function removeFromListModal() {
      const title = document.getElementById('modalTitle').textContent;
      const item = Array.from(listItems).find(i => i.getAttribute('data-title') === title);

      // remove from storage
      try {
        const KEY = 'watchlist';
        const list = JSON.parse(localStorage.getItem(KEY)) || [];
        const idx = list.findIndex(i => i.title === title);
        if (idx !== -1) { list.splice(idx,1); localStorage.setItem(KEY, JSON.stringify(list)); }
      } catch(e) { /* ignore */ }

      if (item) {
        item.style.animation = 'fadeOut 0.3s ease';
        setTimeout(() => {
          item.remove();
          closeModal();
          showToast(`"${title}" removed from your list`);
          updateStats();
        }, 300);
      }
    }

    listItems.forEach(item => {
      item.addEventListener('click', function(e) {
        if (!e.target.closest('.action-btn')) {
          const title = this.getAttribute('data-title');
          openModal(title);
        }
      });
    });

    document.getElementById('contentModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeModal();
      }
    });

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    listItems.forEach(item => {
      item.style.opacity = '0';
      item.style.transform = 'translateY(20px)';
      item.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
      observer.observe(item);
    });

    updateStats();
  </script>
</body>
</html>